{
  // Use IntelliSense to learn about possible attributes.
  // Hover to view descriptions of existing attributes.
  // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
  "version": "0.2.0",
  "configurations": [
    //ng serve
    {
      "name": "ng serve",
      "type": "chrome",
      "request": "launch",
      "preLaunchTask": "npm start frontend",
      "url": "http://localhost:4200/",
      "webRoot": "${workspaceFolder}",
      "sourceMapPathOverrides": {
        "webpack:///./~/*": "${workspaceFolder}/frontend/node_modules/*",
        "webpack:///./*": "${workspaceFolder}/frontend/*",
        "webpack:///*":     "frontend/*",
        "webpack:///src/*": "${workspaceFolder}/frontend/src*",
      },
    },
    // ng test
    {
      "name": "ng test",
      "type": "chrome",
      "request": "launch",
      "runtimeExecutable": "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe",
      "runtimeArgs": [
        "--remote-debugging-port=9222",
        "--incognito",
        "--start-maximized",
        "--new-window",
        "--disable-popup-blocking", // necessary for window.open() to work
      ],
      "userDataDir": true,
      "url": "http://localhost:9876/debug.html",
      // tell vscode where to find scripts on the server
      "webRoot": "${workspaceFolder}/frontend/dist/angular-tour-of-heroes",
      "pathMapping": {
        "/": "${workspaceFolder}/frontend/dist/angular-tour-of-heroes",
        "/testServer": "${workspaceFolder}/backend/server/test/client/browser",
      },
      "sourceMapPathOverrides": {
        "webpack:///./~/*": "${workspaceFolder}/frontend/node_modules/*",
        "webpack:///./*": "${workspaceFolder}/frontend/*",
        "webpack:///*":     "frontend/*",
        "webpack:///src/*": "${workspaceFolder}/frontend/src*",
      },
      "smartStep": true,
      "disableNetworkCache": true,
      "showAsyncStacks": true,
      "sourceMaps": true,
    },
    // ng e2e
    {
      "name": "ng e2e",
      "type": "node",
      "request": "launch",
      "program": "${workspaceFolder}/frontend//node_modules/protractor/bin/protractor",
      "protocol": "inspector",
      "args": ["${workspaceFolder}/frontend/e2e/protractor.conf.js"],
      "outputCapture": "std",
      "console": "integratedTerminal",
      "internalConsoleOptions": "neverOpen",
      "skipFiles": [
        "<node_internals>/**/*.js",
        "${workspaceFolder}/frontend/node_modules/**/*",
        "${workspaceFolder}/frontend/node_modules/**/*.js",
      ],
    },
    // Current .js file
    {
      "type": "node",
      "request": "launch",
      "name": "Launch the currently opened .js file",
      "program": "${file}",
      "env": {
      },
      "outputCapture": "std",
      "console": "integratedTerminal",
      "internalConsoleOptions": "neverOpen",
      "skipFiles": [
        "<node_internals>/**/*.js",
        "${workspaceFolder}/backend/node_modules/**/*",
        "${workspaceFolder}/backend/node_modules/**/*.js",
      ],
      "autoAttachChildProcesses": true,
    },
    // server index.js
    {
      "type": "node",
      "request": "launch",
      "name": "Launch server index.js",
      "protocol": "inspector",
      "program": "${workspaceFolder}/backend/server/src/index.ts",
      "cwd":  "${workspaceFolder}/backend",
      "env": {
      },
      "outputCapture": "std",
      "console": "integratedTerminal",
      "internalConsoleOptions": "neverOpen",
      "skipFiles": [
        "<node_internals>/**/*.js",
        "${workspaceFolder}/backend/node_modules/**/*",
        "${workspaceFolder}/backend/node_modules/**/*.js",
      ],
      "autoAttachChildProcesses": true,
      "sourceMaps": true,
      "outFiles": [
        "${workspaceFolder}/backend/dist/**/*.js",
      ],
      "smartStep": false,
    },
    // NPM server index.js
    {
      /* Runs an npm script to start index.js.
      * Note that CTRL+C does not exit without manual intervention.
      * Click on the VSCode 'stop' icon to exit without manual intervention */
      "type": "node",
      "request": "launch",
      "name": "NPM server index.js",
      "cwd": "${workspaceFolder}/backend",
      "runtimeExecutable": "npm",
      "runtimeArgs": [
        "run-script",
        "debug", "--silent"
      ],
      "port": 9229,
      "outFiles": [
        "${workspaceFolder}/backend/dist/**/*.js"
      ],
      "env": {
      },
      "outputCapture": "std",
      "console": "integratedTerminal", // allows you use CTRL+C to exit
      "internalConsoleOptions": "neverOpen",
      "skipFiles": [
        "<node_internals>/**/*.js",
        "${workspaceFolder}/backend/node_modules/**/*",
        "${workspaceFolder}/backend/node_modules/**/*.js",
      ],
      "autoAttachChildProcesses": true,
      "sourceMaps": true,
    },
    // monitor.js
    {
      "type": "node",
      "request": "launch",
      "name": "Launch monitor.js",
      "program": "${workspaceFolder}/backend/monitor/src/index.ts",
      "cwd":  "${workspaceFolder}/backend",
      "env": {
      },
      "outputCapture": "std",
      "console": "integratedTerminal", // allows you use CTRL+C to exit
      "internalConsoleOptions": "neverOpen",
      "skipFiles": [
        "<node_internals>/**/*.js",
        "${workspaceFolder}/backend/node_modules/**/*",
        "${workspaceFolder}/backend/node_modules/**/*.js",
      ],
      "autoAttachChildProcesses": true,
      "sourceMaps": true,
      "outFiles": [
        "${workspaceFolder}/backend/dist/**/*.js",
      ],
      "smartStep": false,
    },
    // database index.js
    {
      "type": "node",
      "request": "launch",
      "name": "Launch database index.js",
      "protocol": "inspector",
      "program": "${workspaceFolder}/backend/database/src/index.ts",
      "cwd":  "${workspaceFolder}/backend",
      "env": {
      },
      "outputCapture": "std",
      "console": "integratedTerminal",
      "internalConsoleOptions": "neverOpen",
      "skipFiles": [
        "<node_internals>/**/*.js",
        "${workspaceFolder}/backend/node_modules/**/*",
        "${workspaceFolder}/backend/node_modules/**/*.js",
      ],
      "autoAttachChildProcesses": true,
      "sourceMaps": true,
      "outFiles": [
        "${workspaceFolder}/backend/dist/**/*.js",
      ],
      "smartStep": false,
    },
    // https://localhost:1337/
    {
      // starts Chrome and connect to the home page
      // the server must be started in advance of running this
      "name": "Launch https://localhost:1337/",
      "type": "chrome",
      "request": "launch",
      "runtimeExecutable": "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe",
      "runtimeArgs": [
        "--remote-debugging-port=9222",
        "--incognito",
        "--start-maximized",
        "--new-window",
        "--disable-popup-blocking", // necessary for window.open() to work
      ],
      "userDataDir": true,
      "url": "https://localhost:1337/",
      // tell vscode where to find scripts on the server
      "pathMapping": {
        "/": "${workspaceFolder}/frontend/dist/",
        "/testServer": "${workspaceFolder}/backend/dist/server/test/client/",
      },
      "sourceMapPathOverrides": {
        "webpack:///./~/*": "${workspaceFolder}/frontend/node_modules/*",
        "webpack:///./*": "${workspaceFolder}/frontend/*",
        "webpack:///*":     "frontend/*",
        "webpack:///src/*": "${workspaceFolder}/frontend/src*",
      },
      "smartStep": true,
      "disableNetworkCache": true,
      "showAsyncStacks": true,
      "sourceMaps": true,
      "preLaunchTask": "Is Server Up?", // must delay to allow server start for use in compounds
      "trace": true,
    },
    // Mocha Backend
    {
    "type": "node",
    "request": "launch",
    "name": "Mocha Backend",
    "program": "${workspaceFolder}/backend/node_modules/mocha/bin/_mocha",
    "args": [
      "--config", "${workspaceFolder}/backend/.mocharc.json",
      /* include testSetup.js to load .env */
      "${workspaceFolder}/backend/dist/test/testSetup.js",
      /* comment out files to select tests */
      "${workspaceFolder}/backend/dist/database/test/*.test.js",
      "${workspaceFolder}/backend/dist/models/test/*.test.js",
      "${workspaceFolder}/backend/dist/utils/test/*.test.js",
      "${workspaceFolder}/backend/dist/server/test/client-fired/api-server-side.test.js",
      "${workspaceFolder}/backend/dist/server/test/client-fired/errors-server-side.test.js",
      "${workspaceFolder}/backend/server/test/*.js",
      "${workspaceFolder}/backend/dist/monitor/test/*.test.js",
    ],
    "env": {
      /* set before all tests so test database used */
      "TEST_MODE_1": "true",
      /* set to 'true' to automatically run chrome and set tp 'false' when using a compound configuration to launch chrome */
      "RUN_CHROME": "true",
    },
    "cwd": "${workspaceFolder}/backend",
    "outputCapture": "std",
    "console": "integratedTerminal", // allows you use CTRL+C to exit
    "internalConsoleOptions": "neverOpen",
    "skipFiles": [
      "<node_internals>/**/*.js",
      "${workspaceFolder}/backend/node_modules/**/*",
      "${workspaceFolder}/backend/node_modules/**/*.js",
    ],
    "autoAttachChildProcesses": true,
    // "preLaunchTask": "Taskkill node.exe", // kill any previously failed node runs
    },
    // Mocha Backend with istanbul
    {
      "type": "node",
      "request": "launch",
      "name": "Mocha Backend with istanbul",
      "program": "${workspaceFolder}/backend/node_modules/nyc/bin/nyc",
      "args": [
        "--reporter=text",
        "--reporter=html",
        "--report-dir", "${workspaceFolder}/backend/coverage/all",
        "${workspaceFolder}/backend/node_modules/mocha/bin/_mocha",
        "--config", "${workspaceFolder}/backend/.mocharc.json",
        /* include testSetup.js to load .env */
        "${workspaceFolder}/backend/dist/test/testSetup.js",
        /* comment out files to select tests */
        "${workspaceFolder}/backend/dist/database/test/*.test.js",
        "${workspaceFolder}/backend/dist/models/test/*.test.js",
        "${workspaceFolder}/backend/dist/utils/test/*.test.js",
        "${workspaceFolder}/backend/dist/server/test/client-fired/api-server-side.test.js",
        "${workspaceFolder}/backend/dist/server/test/client-fired/errors-server-side.test.js",
        "${workspaceFolder}/backend/server/test/*.js",
        "${workspaceFolder}/backend/dist/monitor/test/*.test.js",
      ],
      "env": {
        /* set before all tests so test database used */
        "TEST_MODE_1": "true",
        /* set to 'true' to automatically run chrome and set tp 'false' when using a compound configuration to launch chrome */
        "RUN_CHROME": "true",
      },
      "cwd": "${workspaceFolder}/backend",
      "outputCapture": "std",
      "console": "integratedTerminal", // allows you use CTRL+C to exit
      "internalConsoleOptions": "neverOpen",
      "skipFiles": [
        "<node_internals>/**/*.js",
        "${workspaceFolder}/backend/node_modules/**/*",
        "${workspaceFolder}/backend/node_modules/**/*.js",
      ],
      "autoAttachChildProcesses": true,
      // "preLaunchTask": "Taskkill node.exe", // kill any failed node runs
      "postDebugTask": "npm delete nyc file", // delete .nyc_report
    },
    // Mocha Client-fired server tests - for use in compound for client-side debug
    {
      /* This runs a server-side mocha client test file to test the server-side behaviour during client-side fired tests. */
      /* If Run_Chrome is set true it kicks off the browser tests that fire the client-side tests.  Otherwise you can load testServer/loadmocha.html manually, or if you need debug of the browser-side then use a launch configuration to load the matching loadMocha.html. */
      /* A compound configuration set up for use when debugging client-side test scripts */
      "type": "node",
      "request": "launch",
      "name": "Mocha Client-fired Server Tests",
      "program": "${workspaceFolder}/backend/node_modules/mocha/bin/_mocha",
      "args": [
        "--config", "${workspaceFolder}/backend/.mocharc.json",
        /* include testSetup.js to load .env */
        "${workspaceFolder}/backend/dist/test/testSetup.js",
        /* comment out files to select a test */
        "${workspaceFolder}/backend/dist/server/test/client-fired/api-server-side.test.js",
        // "${workspaceFolder}/backend/dist/server/test/client-fired/errors-server-side.test.js",
      ],
      "env": {
        /* set before all tests so test database used */
        "TEST_MODE_1": "true",
        /* set to 'true' to automatically run chrome and set tp 'false' when using a compound configuration to launch chrome */
        "RUN_CHROME": "false",
      },
      "cwd": "${workspaceFolder}/backend",
      "outputCapture": "std",
      "console": "integratedTerminal", // allows you use CTRL+C to exit
      "internalConsoleOptions": "neverOpen",
      "skipFiles": [
        "<node_internals>/**/*.js",
        "${workspaceFolder}/backend/node_modules/**/*",
        "${workspaceFolder}/backend/node_modules/**/*.js",
      ],
      "autoAttachChildProcesses": true,
    },
    // https://localhost:1337/testServer/xxx/loadMocha.html
    {
      // starts Chrome and loads the a client-side browser test runner.
      // the equivalent server-side client tests (with Run Chrome disabled) must be started in advance of running this
      "name": "Launch https://localhost:1337/testServer/xxx/loadMocha.html",
      "type": "chrome",
      "request": "launch",
      "runtimeExecutable": "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe",
      "runtimeArgs": [
        "--remote-debugging-port=9222",
        "--incognito",
        "--start-maximized",
        "--new-window",
        "--disable-popup-blocking", // necessary for window.open() to work
      ],
      "userDataDir": true,
      /* comment out to run a specific loadMocha*/
      "url": "https://localhost:1337/testServer/api/static/loadmocha.html",
      // "url": "https://localhost:1337/testServer/errors/static/loadmocha.html",
      // tell vscode where to find scripts on the server
      "pathMapping": {
        "/": "${workspaceFolder}/frontend/dist/",
        "/testServer": "${workspaceFolder}/backend/dist/server/test/client",
      },
      "sourceMapPathOverrides": {
        "webpack:///./~/*": "${workspaceFolder}/frontend/node_modules/*",
        "webpack:///./*": "${workspaceFolder}/frontend/*",
        "webpack:///*":     "frontend/*",
        "webpack:///src/*": "${workspaceFolder}/frontend/src*",
      },
      "smartStep": true,
      "disableNetworkCache": true,
      "showAsyncStacks": true,
      "sourceMaps": true,
      "preLaunchTask": "Is Server Up?", // must delay to allow server start for use in compounds
      "trace": true,
    },
  ],
  "compounds": [
    /* Run backend server and chrome */
    {
      /* To debug angular you may need to go into Chrome and ensure filesystem added. If you have difficulty setting breakpoints in vscode then set them in Chrome. */
      "name": "Backend/Frontend",
      "configurations": [
        "Launch server index.js",
        "Launch https://localhost:1337/",
      ]

    },
    /* Run backend server and ng serve */
    {
      "name": "Server/ng serve",
      "configurations": [
        "Launch server index.js",
        "ng serve",
      ]

    },
    /* Mocha client tests Backend/Frontend */
    /* Useful for debugging client-side test scripts */
    {
      "name": "Mocha client tests Backend/Frontend",
      /* use when debugging client-side mocha scripts */
      /* You must set RUN_CHROME to 'false' and disable Taskkill on Mocha Client-fired server Tests before running this */
      /* you must close Chrome manually afterwards */
      /* you must match the tests in both configurations below */
      "configurations": [
        "Mocha Client-fired Server Tests",
        "Launch https://localhost:1337/testServer/xxx/loadMocha.html",
      ]
    },
  ],
}
